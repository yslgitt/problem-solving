# ğŸ‘» 20056. ë§ˆë²•ì‚¬ ìƒì–´ì™€ íŒŒì´ì–´ë³¼

[ğŸ“ ë¬¸ì œë§í¬]: https://www.acmicpc.net/problem/20056



#### ğŸ’â€â™€ï¸ ë¬¸ì œ ì„¤ëª…

[ì–´ë¥¸ ìƒì–´](https://www.acmicpc.net/problem/19237)ê°€ ë§ˆë²•ì‚¬ê°€ ë˜ì—ˆê³ , íŒŒì´ì–´ë³¼ì„ ë°°ì› ë‹¤.

ë§ˆë²•ì‚¬ ìƒì–´ê°€ í¬ê¸°ê°€ NÃ—Nì¸ ê²©ìì— íŒŒì´ì–´ë³¼ Mê°œë¥¼ ë°œì‚¬í–ˆë‹¤. ê°€ì¥ ì²˜ìŒì— íŒŒì´ì–´ë³¼ì€ ê°ì ìœ„ì¹˜ì—ì„œ ì´ë™ì„ ëŒ€ê¸°í•˜ê³  ìˆë‹¤. ië²ˆ íŒŒì´ì–´ë³¼ì˜ ìœ„ì¹˜ëŠ” (ri, ci), ì§ˆëŸ‰ì€ miì´ê³ , ë°©í–¥ì€ di, ì†ë ¥ì€ siì´ë‹¤. ìœ„ì¹˜ (r, c)ëŠ” rí–‰ cì—´ì„ ì˜ë¯¸í•œë‹¤.

ê²©ìì˜ í–‰ê³¼ ì—´ì€ 1ë²ˆë¶€í„° Në²ˆê¹Œì§€ ë²ˆí˜¸ê°€ ë§¤ê²¨ì ¸ ìˆê³ , 1ë²ˆ í–‰ì€ Në²ˆê³¼ ì—°ê²°ë˜ì–´ ìˆê³ , 1ë²ˆ ì—´ì€ Në²ˆ ì—´ê³¼ ì—°ê²°ë˜ì–´ ìˆë‹¤.

íŒŒì´ì–´ë³¼ì˜ ë°©í–¥ì€ ì–´ë–¤ ì¹¸ê³¼ ì¸ì ‘í•œ 8ê°œì˜ ì¹¸ì˜ ë°©í–¥ì„ ì˜ë¯¸í•˜ë©°, ì •ìˆ˜ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

| 7    | 0    | 1    |
| ---- | ---- | ---- |
| 6    |      | 2    |
| 5    | 4    | 3    |

ë§ˆë²•ì‚¬ ìƒì–´ê°€ ëª¨ë“  íŒŒì´ì–´ë³¼ì—ê²Œ ì´ë™ì„ ëª…ë ¹í•˜ë©´ ë‹¤ìŒì´ ì¼ë“¤ì´ ì¼ì–´ë‚œë‹¤.

1. ëª¨ë“  íŒŒì´ì–´ë³¼ì´ ìì‹ ì˜ ë°©í–¥ dië¡œ ì†ë ¥ siì¹¸ ë§Œí¼ ì´ë™í•œë‹¤.
   - ì´ë™í•˜ëŠ” ì¤‘ì—ëŠ” ê°™ì€ ì¹¸ì— ì—¬ëŸ¬ ê°œì˜ íŒŒì´ì–´ë³¼ì´ ìˆì„ ìˆ˜ë„ ìˆë‹¤.
2. ì´ë™ì´ ëª¨ë‘ ëë‚œ ë’¤, 2ê°œ ì´ìƒì˜ íŒŒì´ì–´ë³¼ì´ ìˆëŠ” ì¹¸ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¼ì´ ì¼ì–´ë‚œë‹¤.
   1. ê°™ì€ ì¹¸ì— ìˆëŠ” íŒŒì´ì–´ë³¼ì€ ëª¨ë‘ í•˜ë‚˜ë¡œ í•©ì³ì§„ë‹¤.
   2. íŒŒì´ì–´ë³¼ì€ 4ê°œì˜ íŒŒì´ì–´ë³¼ë¡œ ë‚˜ëˆ„ì–´ì§„ë‹¤.
   3. ë‚˜ëˆ„ì–´ì§„ íŒŒì´ì–´ë³¼ì˜ ì§ˆëŸ‰, ì†ë ¥, ë°©í–¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
      1. ì§ˆëŸ‰ì€ âŒŠ(í•©ì³ì§„ íŒŒì´ì–´ë³¼ ì§ˆëŸ‰ì˜ í•©)/5âŒ‹ì´ë‹¤.
      2. ì†ë ¥ì€ âŒŠ(í•©ì³ì§„ íŒŒì´ì–´ë³¼ ì†ë ¥ì˜ í•©)/(í•©ì³ì§„ íŒŒì´ì–´ë³¼ì˜ ê°œìˆ˜)âŒ‹ì´ë‹¤.
      3. í•©ì³ì§€ëŠ” íŒŒì´ì–´ë³¼ì˜ ë°©í–¥ì´ ëª¨ë‘ í™€ìˆ˜ì´ê±°ë‚˜ ëª¨ë‘ ì§ìˆ˜ì´ë©´, ë°©í–¥ì€ 0, 2, 4, 6ì´ ë˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 1, 3, 5, 7ì´ ëœë‹¤.
   4. ì§ˆëŸ‰ì´ 0ì¸ íŒŒì´ì–´ë³¼ì€ ì†Œë©¸ë˜ì–´ ì—†ì–´ì§„ë‹¤.

ë§ˆë²•ì‚¬ ìƒì–´ê°€ ì´ë™ì„ Kë²ˆ ëª…ë ¹í•œ í›„, ë‚¨ì•„ìˆëŠ” íŒŒì´ì–´ë³¼ ì§ˆëŸ‰ì˜ í•©ì„ êµ¬í•´ë³´ì.



##### ì…ë ¥

> ì²«ì§¸ ì¤„ì— N, M, Kê°€ ì£¼ì–´ì§„ë‹¤.
>
> ë‘˜ì§¸ ì¤„ë¶€í„° Mê°œì˜ ì¤„ì— íŒŒì´ì–´ë³¼ì˜ ì •ë³´ê°€ í•œ ì¤„ì— í•˜ë‚˜ì”© ì£¼ì–´ì§„ë‹¤. íŒŒì´ì–´ë³¼ì˜ ì •ë³´ëŠ” ë‹¤ì„¯ ì •ìˆ˜ ri, ci, mi, si, dië¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.
>
> ì„œë¡œ ë‹¤ë¥¸ ë‘ íŒŒì´ì–´ë³¼ì˜ ìœ„ì¹˜ê°€ ê°™ì€ ê²½ìš°ëŠ” ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.
>
> - 4 â‰¤ N â‰¤ 50
> - 0 â‰¤ M â‰¤ N2
> - 1 â‰¤ K â‰¤ 1,000
> - 1 â‰¤ ri, ci â‰¤ N
> - 1 â‰¤ mi â‰¤ 1,000
> - 1 â‰¤ si â‰¤ 1,000
> - 0 â‰¤ di â‰¤ 7



##### ì¶œë ¥

> ë§ˆë²•ì‚¬ ìƒì–´ê°€ ì´ë™ì„ Kë²ˆ ëª…ë ¹í•œ í›„, ë‚¨ì•„ìˆëŠ” íŒŒì´ì–´ë³¼ ì§ˆëŸ‰ì˜ í•©ì„ ì¶œë ¥í•œë‹¤.



-----



#### ğŸ¤¸â€â™‚ï¸ ë¬¸ì œ í•´ê²°

```python
N, M, K = map(int,input().split())

# ë°©í–¥
dr = [-1, -1, 0, 1, 1, 1, 0, -1]
dc = [0, 1, 1, 1, 0, -1, -1, -1]

#ì…ë ¥ ë°›ê¸°
stack = []
for _ in range(M):
    r, c, m, s, d = map(int,input().split())
    stack.append([r%N, c%N, m, s, d])

for _ in range(K):
    next = [[[0] * 4 for _ in range(N)] for _ in range(N)] # ì´ë™ ë§µ
    ball = [] # ë³¼ ìœ„ì¹˜ ë°›ì„ ë¦¬ìŠ¤íŠ¸
    while stack:
        nr, nc, nm, ns, nd = stack.pop()
        tr, tc = (nr + ns * dr[nd]) % N, (nc + ns * dc[nd]) % N # ìœ„ì¹˜ ì´ë™
        next[tr][tc][0] += nm # ì§ˆëŸ‰
        next[tr][tc][1] += ns # ì†ë„
        next[tr][tc][3] += 1 # ë”í•´ì§„ ë³¼ ìˆ˜
        # ë°©í–¥
        if next[tr][tc][3] == 1: # 1ê°œì¼ ê²½ìš° 
            next[tr][tc][2] = nd # ë°©í–¥ ì •ë³´ ê·¸ëŒ€ë¡œ ë°›ìŒ
            ball.append((tr,tc))
        elif next[tr][tc][3] == 2: # 2ê°œì¼ ê²½ìš°
            next[tr][tc][2] = next[tr][tc][2] % 2 + nd % 2 # ì´ì „ ì •ë³´ % 2 + í˜„ ì •ë³´ % 2
        else:
            next[tr][tc][2] += nd % 2 # + í˜„ ì •ë³´ % 2
	
    # ìœ„ì¹˜ ë³„ ê³µë“¤ ìŠ¤íƒ ë„£ê¸°
    for r, c in ball:
        if next[r][c][3] == 1: # í•©ì³ì§„ ê³µì´ ì—†ìœ¼ë©´
            stack.append([r, c, next[r][c][0], next[r][c][1], next[r][c][2]]) # ì •ë³´ ê·¸ëŒ€ë¡œ ìŠ¤íƒ ë„£ê¸°
		
        # ê³µì´ 2ê°œ ì´ìƒ í•©ì³ì¡Œì„ ê²½ìš°
        else:
            if next[r][c][0] < 5: # ì§ˆëŸ‰ì´ 0ì´ ë˜ë©´ ê³µ ì†Œë©¸
                continue

            else: # ì†Œë©¸ë˜ì§€ ì•Šì€ ê²½ìš°
                tm = next[r][c][0] // 5 # ì§ˆëŸ‰ 
                ts = next[r][c][1] // next[r][c][3] # ì†ë„
                # ë°©í–¥
                # í™€í™€í™€í™€, ì§ì§ì§ì§ì´ ëª¨ì¼ê²½ìš° ê²°ê³¼ ê°’ì€ ê³µì˜ ìˆ˜, 0  
                # ê³ ë¡œ ê³µì˜ ê°œìˆ˜ë¡œ ë‚˜ëˆ„ë©´ ë‚˜ë¨¸ì§€ê°€ ë¬´ì¡°ê±´ 0ì„
                if next[r][c][2] % next[r][c][3]:  # í™€ì§ì´ ì„ì˜€ì„ ê²½ìš°
                    for td in (1,3,5,7):
                        stack.append([r, c, tm, ts, td]) 
                else: # ì•„ë‹Œ ê²½ìš°
                    for td in (0,2,4,6):
                        stack.append([r, c, tm, ts, td])

result = 0
for i in range(len(stack)):
    result += stack[i][2]

print(result)
```

- êµ¬í˜„



##### *ì˜¤ë¥˜*

- ë°©í–¥ ì •ë³´ ë¶„ê¸°ë¥¼ ì–„íŒí•˜ê²Œ ì„¤ì •í•¨.

