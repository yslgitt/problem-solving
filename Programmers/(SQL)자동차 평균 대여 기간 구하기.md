# ðŸ’š (SQL) ìžë™ì°¨ í‰ê·  ëŒ€ì—¬ ê¸°ê°„ êµ¬í•˜ê¸°

[ðŸ“ ë¬¸ì œë§í¬]: https://school.programmers.co.kr/learn/courses/30/lessons/157342



#### ðŸ’â€â™€ï¸ ë¬¸ì œ ì„¤ëª…

ë‹¤ìŒì€ ì–´ëŠ ìžë™ì°¨ ëŒ€ì—¬ íšŒì‚¬ì˜ ìžë™ì°¨ ëŒ€ì—¬ ê¸°ë¡ ì •ë³´ë¥¼ ë‹´ì€ `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ìž…ë‹ˆë‹¤. `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì€ ì•„ëž˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ìžˆìœ¼ë©°, `HISTORY_ID`, `CAR_ID`, `START_DATE`, `END_DATE` ëŠ” ê°ê° ìžë™ì°¨ ëŒ€ì—¬ ê¸°ë¡ ID, ìžë™ì°¨ ID, ëŒ€ì—¬ ì‹œìž‘ì¼, ëŒ€ì—¬ ì¢…ë£Œì¼ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

| Column name | Type    | Nullable |
| ----------- | ------- | -------- |
| HISTORY_ID  | INTEGER | FALSE    |
| CAR_ID      | INTEGER | FALSE    |
| START_DATE  | DATE    | FALSE    |
| END_DATE    | DATE    | FALSE    |



##### ë¬¸ì œ

`CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì—ì„œ í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì´ 7ì¼ ì´ìƒì¸ ìžë™ì°¨ë“¤ì˜ ìžë™ì°¨ IDì™€ í‰ê·  ëŒ€ì—¬ ê¸°ê°„(ì»¬ëŸ¼ëª…: `AVERAGE_DURATION`) ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” SQLë¬¸ì„ ìž‘ì„±í•´ì£¼ì„¸ìš”. í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì€ ì†Œìˆ˜ì  ë‘ë²ˆì§¸ ìžë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼í•˜ê³ , ê²°ê³¼ëŠ” í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì£¼ì‹œê³ , í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì´ ê°™ìœ¼ë©´ ìžë™ì°¨ IDë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì£¼ì„¸ìš”.



##### ì˜ˆì‹œ

ì˜ˆë¥¼ ë“¤ì–´ `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì´ ë‹¤ìŒê³¼ ê°™ë‹¤ë©´

| HISTORY_ID | CAR_ID | START_DATE | END_DATE   |
| ---------- | ------ | ---------- | ---------- |
| 1          | 1      | 2022-09-27 | 2022-10-01 |
| 2          | 1      | 2022-10-03 | 2022-11-04 |
| 3          | 2      | 2022-09-05 | 2022-09-05 |
| 4          | 2      | 2022-09-08 | 2022-09-10 |
| 5          | 3      | 2022-09-16 | 2022-10-15 |
| 6          | 1      | 2022-11-07 | 2022-12-06 |

ìžë™ì°¨ ë³„ í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì€

- ìžë™ì°¨ IDê°€ 1ì¸ ìžë™ì°¨ì˜ ê²½ìš°, ëŒ€ì—¬ ê¸°ê°„ì´ ê°ê° 5ì¼, 33ì¼, 30ì¼ì¸ ê¸°ë¡ì´ ì¡´ìž¬í•˜ë¯€ë¡œ í‰ê·  22.7ì¼
- ìžë™ì°¨ IDê°€ 2ì¸ ìžë™ì°¨ì˜ ê²½ìš°, ëŒ€ì—¬ ê¸°ê°„ì´ ê°ê° 1ì¼, 3ì¼ì¸ ê¸°ë¡ì´ ì¡´ìž¬í•˜ë¯€ë¡œ í‰ê·  2ì¼
- ìžë™ì°¨ IDê°€ 3ì¸ ìžë™ì°¨ì˜ ê²½ìš°, ëŒ€ì—¬ ê¸°ê°„ì´ 30ì¼ì¸ ê¸°ë¡ë§Œ ì¡´ìž¬í•˜ë¯€ë¡œ í‰ê·  30ì¼ ìž…ë‹ˆë‹¤. í‰ê·  ëŒ€ì—¬ ê¸°ê°„ì´ 7ì¼ ì´ìƒì¸ ìžë™ì°¨ëŠ” ìžë™ì°¨ IDê°€ 1, 3ì¸ ìžë™ì°¨ì´ê³ , í‰ê·  ëŒ€ì—¬ ê¸°ê°„ ë‚´ë¦¼ì°¨ìˆœ ë° ìžë™ì°¨ IDë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì™€ì•¼ í•©ë‹ˆë‹¤.

| CAR_ID | AVERAGE_DURATION |
| ------ | ---------------- |
| 3      | 30.0             |
| 1      | 22.7             |

----



#### ðŸ¤¸â€â™‚ï¸ ë¬¸ì œ í•´ê²°

```mysql
SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE, START_DATE)+1), 1) AS AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING AVERAGE_DURATION >= 7
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC
```

