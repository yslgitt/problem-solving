# ðŸ’š (SQL) ìžë™ì°¨ ëŒ€ì—¬ ê¸°ë¡ì—ì„œ ìž¥ê¸°/ë‹¨ê¸° ëŒ€ì—¬ êµ¬ë¶„í•˜ê¸°

[ðŸ“ ë¬¸ì œë§í¬]: https://school.programmers.co.kr/learn/courses/30/lessons/151138



#### ðŸ’â€â™€ï¸ ë¬¸ì œ ì„¤ëª…

ë‹¤ìŒì€ ì–´ëŠ ìžë™ì°¨ ëŒ€ì—¬ íšŒì‚¬ì˜ ìžë™ì°¨ ëŒ€ì—¬ ê¸°ë¡ ì •ë³´ë¥¼ ë‹´ì€ `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ìž…ë‹ˆë‹¤. `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì€ ì•„ëž˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ìžˆìœ¼ë©°, `HISTORY_ID`, `CAR_ID`, `START_DATE`, `END_DATE` ëŠ” ê°ê° ìžë™ì°¨ ëŒ€ì—¬ ê¸°ë¡ ID, ìžë™ì°¨ ID, ëŒ€ì—¬ ì‹œìž‘ì¼, ëŒ€ì—¬ ì¢…ë£Œì¼ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

| Column name | Type    | Nullable |
| ----------- | ------- | -------- |
| HISTORY_ID  | INTEGER | FALSE    |
| CAR_ID      | INTEGER | FALSE    |
| START_DATE  | DATE    | FALSE    |
| END_DATE    | DATE    | FALSE    |



##### ë¬¸ì œ

`CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì—ì„œ ëŒ€ì—¬ ì‹œìž‘ì¼ì´ 2022ë…„ 9ì›”ì— ì†í•˜ëŠ” ëŒ€ì—¬ ê¸°ë¡ì— ëŒ€í•´ì„œ ëŒ€ì—¬ ê¸°ê°„ì´ 30ì¼ ì´ìƒì´ë©´ 'ìž¥ê¸° ëŒ€ì—¬' ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 'ë‹¨ê¸° ëŒ€ì—¬' ë¡œ í‘œì‹œí•˜ëŠ” ì»¬ëŸ¼(ì»¬ëŸ¼ëª…: `RENT_TYPE`)ì„ ì¶”ê°€í•˜ì—¬ ëŒ€ì—¬ê¸°ë¡ì„ ì¶œë ¥í•˜ëŠ” SQLë¬¸ì„ ìž‘ì„±í•´ì£¼ì„¸ìš”. ê²°ê³¼ëŠ” ëŒ€ì—¬ ê¸°ë¡ IDë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì£¼ì„¸ìš”.



##### ì˜ˆì‹œ

ì˜ˆë¥¼ ë“¤ì–´ `CAR_RENTAL_COMPANY_RENTAL_HISTORY` í…Œì´ë¸”ì´ ë‹¤ìŒê³¼ ê°™ë‹¤ë©´

| HISTORY_ID | CAR_ID | START_DATE | END_DATE   |
| ---------- | ------ | ---------- | ---------- |
| 1          | 4      | 2022-09-27 | 2022-11-27 |
| 2          | 3      | 2022-10-03 | 2022-11-04 |
| 3          | 2      | 2022-09-05 | 2022-09-05 |
| 4          | 1      | 2022-09-01 | 2022-09-30 |
| 5          | 3      | 2022-09-16 | 2022-10-15 |

2022ë…„ 9ì›”ì˜ ëŒ€ì—¬ ê¸°ë¡ ì¤‘ 'ìž¥ê¸° ëŒ€ì—¬' ì— í•´ë‹¹í•˜ëŠ” ê¸°ë¡ì€ ëŒ€ì—¬ ê¸°ë¡ IDê°€ 1, 4ì¸ ê¸°ë¡ì´ê³ , 'ë‹¨ê¸° ëŒ€ì—¬' ì— í•´ë‹¹í•˜ëŠ” ê¸°ë¡ì€ ëŒ€ì—¬ ê¸°ë¡ IDê°€ 3, 5 ì¸ ê¸°ë¡ì´ë¯€ë¡œ ëŒ€ì—¬ ê¸°ë¡ IDë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì™€ì•¼ í•©ë‹ˆë‹¤.

| HISTORY_ID | CAR_ID | START_DATE | END_DATE   | RENT_TYPE |
| ---------- | ------ | ---------- | ---------- | --------- |
| 5          | 3      | 2022-09-16 | 2022-10-13 | ë‹¨ê¸° ëŒ€ì—¬ |
| 4          | 1      | 2022-09-01 | 2022-09-30 | ìž¥ê¸° ëŒ€ì—¬ |
| 3          | 2      | 2022-09-05 | 2022-09-05 | ë‹¨ê¸° ëŒ€ì—¬ |
| 1          | 4      | 2022-09-27 | 2022-10-26 | ìž¥ê¸° ëŒ€ì—¬ |

----



#### ðŸ¤¸â€â™‚ï¸ ë¬¸ì œ í•´ê²°

```mysql
SELECT HISTORY_ID, CAR_ID, DATE_FORMAT(START_DATE, '%Y-%m-%d') AS START_DATE, DATE_FORMAT(END_DATE, '%Y-%m-%d') AS END_DATE,
CASE WHEN DATEDIFF(END_DATE, START_DATE) >= 29 THEN 'ìž¥ê¸° ëŒ€ì—¬' ELSE 'ë‹¨ê¸° ëŒ€ì—¬' END AS RENT_TYPE
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE DATE_FORMAT(START_DATE, '%Y-%m') = '2022-09'
ORDER BY HISTORY_ID DESC
```



